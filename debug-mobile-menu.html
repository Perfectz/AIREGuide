<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Menu Debug Test</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <style>
        /* Debug styles */
        .debug-info {
            position: fixed;
            top: 0;
            right: 0;
            background: black;
            color: lime;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            z-index: 10000;
            max-width: 300px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        /* Override md:hidden for debugging */
        .force-visible {
            display: flex !important;
        }
        
        /* Make mobile menu visible when toggled */
        #mobile-menu.show {
            display: block !important;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="debug-info" id="debugInfo">
        <div>Debug Log:</div>
        <div id="debugLog"></div>
    </div>

    <!-- Copy the exact mobile header structure from main app -->
    <header class="md:hidden force-visible items-center justify-between p-4 bg-white border-b border-gray-200 shadow-sm">
        <div class="flex items-center space-x-4">
            <div class="w-8 h-8 bg-indigo-500 rounded-md flex items-center justify-center text-white font-bold text-sm shadow-md">
                AI
            </div>
            <h1 class="text-xl font-semibold text-gray-800">AI Real Estate Playbook</h1>
        </div>
        <button id="menu-btn" class="touch-target p-2 rounded-lg hover:bg-gray-100 active:bg-gray-200 transition-colors" aria-label="Toggle mobile menu" data-tooltip="Toggle navigation menu">
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-4 6h10"></path>
            </svg>
        </button>
    </header>
    
    <!-- Mobile menu, show/hide based on menu state. -->
    <div id="mobile-menu" class="md:hidden hidden bg-white shadow-lg rounded-b-lg text-gray-700">
        <nav id="mobile-nav" class="p-4 space-y-2">
            <a href="#home" class="mobile-nav-item nav-item flex items-center p-3 rounded-lg active-nav hover:bg-gray-100 text-indigo-600 font-medium">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m0 0l7 7m-2 2v-5a1 1 0 00-1-1H9a1 1 0 00-1 1v5"></path></svg>
                <span class="font-medium">Welcome</span>
            </a>
            <a href="#chatgpt-features" class="mobile-nav-item nav-item flex items-center p-3 rounded-lg hover:bg-gray-100 text-gray-700 font-medium">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                <span class="font-medium">ChatGPT Features</span>
            </a>
            <a href="#prompts" class="mobile-nav-item nav-item flex items-center p-3 rounded-lg hover:bg-gray-100 text-gray-700 font-medium">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2v5a2 2 0 01-2 2H9a2 2 0 01-2-2V9a2 2 0 012-2h6z"></path></svg>
                <span class="font-medium">Prompts</span>
            </a>
        </nav>
    </div>

    <main class="container mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-4">Mobile Menu Debug Test - Exact Structure</h1>
        <p class="mb-4">This test uses the exact same HTML structure as the main app. The mobile header should be visible (forced with .force-visible class).</p>
        
        <div class="space-y-4">
            <div class="bg-yellow-100 p-4 rounded-lg">
                <h2 class="font-bold text-yellow-800 mb-2">Current Screen Size:</h2>
                <p id="screenSize" class="text-yellow-700"></p>
            </div>
            
            <div class="bg-blue-100 p-4 rounded-lg">
                <h2 class="font-bold text-blue-800 mb-2">Element Visibility:</h2>
                <div id="elementStatus" class="text-blue-700"></div>
            </div>
            
            <div class="flex gap-4">
                <button onclick="manualToggle()" class="bg-blue-500 text-white px-4 py-2 rounded">
                    Manual Toggle Test
                </button>
                <button onclick="checkElements()" class="bg-green-500 text-white px-4 py-2 rounded">
                    Check Elements
                </button>
                <button onclick="clearLog()" class="bg-red-500 text-white px-4 py-2 rounded">
                    Clear Log
                </button>
                <button onclick="testResponsive()" class="bg-purple-500 text-white px-4 py-2 rounded">
                    Test Responsive
                </button>
            </div>
        </div>
    </main>

    <script>
        // Debug logging
        function log(message) {
            console.log(message);
            const logDiv = document.getElementById('debugLog');
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div>[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('debugLog').innerHTML = '';
        }

        // Manual toggle for testing
        function manualToggle() {
            log('Manual toggle called');
            const menu = document.getElementById('mobile-menu');
            const button = document.getElementById('menu-btn');
            
            if (menu.classList.contains('hidden')) {
                menu.classList.remove('hidden');
                menu.classList.add('show');
                button.setAttribute('aria-expanded', 'true');
                log('Menu opened via manual toggle');
            } else {
                menu.classList.add('hidden');
                menu.classList.remove('show');
                button.setAttribute('aria-expanded', 'false');
                log('Menu closed via manual toggle');
            }
        }

        // Check elements
        function checkElements() {
            const button = document.getElementById('menu-btn');
            const menu = document.getElementById('mobile-menu');
            const header = button?.closest('header');
            
            log('=== ELEMENT CHECK ===');
            log(`Button exists: ${!!button}`);
            log(`Menu exists: ${!!menu}`);
            log(`Header exists: ${!!header}`);
            
            if (button) {
                const rect = button.getBoundingClientRect();
                log(`Button visible: ${button.offsetWidth > 0 && button.offsetHeight > 0}`);
                log(`Button computed display: ${getComputedStyle(button).display}`);
                log(`Button computed visibility: ${getComputedStyle(button).visibility}`);
                log(`Button computed opacity: ${getComputedStyle(button).opacity}`);
                log(`Button pointer-events: ${getComputedStyle(button).pointerEvents}`);
                log(`Button z-index: ${getComputedStyle(button).zIndex}`);
                log(`Button position: ${rect.top}, ${rect.left}, ${rect.width}x${rect.height}`);
            }
            
            if (header) {
                const headerRect = header.getBoundingClientRect();
                log(`Header visible: ${header.offsetWidth > 0 && header.offsetHeight > 0}`);
                log(`Header computed display: ${getComputedStyle(header).display}`);
                log(`Header classes: ${header.className}`);
                log(`Header position: ${headerRect.top}, ${headerRect.left}, ${headerRect.width}x${headerRect.height}`);
            }
            
            if (menu) {
                log(`Menu visible: ${menu.offsetWidth > 0 && menu.offsetHeight > 0}`);
                log(`Menu display: ${getComputedStyle(menu).display}`);
                log(`Menu classes: ${menu.className}`);
            }
            log('=== END CHECK ===');
        }

        // Test responsive behavior
        function testResponsive() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            log(`Screen size: ${width}x${height}`);
            log(`Should show mobile menu: ${width < 768 ? 'YES' : 'NO'}`);
            
            // Update screen size display
            document.getElementById('screenSize').textContent = `${width}x${height} (${width < 768 ? 'Mobile' : 'Desktop'})`;
            
            // Check element visibility
            const button = document.getElementById('menu-btn');
            const header = button?.closest('header');
            const status = document.getElementById('elementStatus');
            
            if (header && button) {
                const headerVisible = getComputedStyle(header).display !== 'none';
                const buttonVisible = getComputedStyle(button).display !== 'none';
                status.innerHTML = `
                    <div>Header visible: ${headerVisible ? '✅' : '❌'}</div>
                    <div>Button visible: ${buttonVisible ? '✅' : '❌'}</div>
                    <div>Header classes: ${header.className}</div>
                `;
            }
        }

        // Navigation Manager (simplified version)
        class NavigationManager {
            constructor() {
                this.init();
            }

            init() {
                log('NavigationManager init called');
                this.initializeMobileMenuToggle();
                
                // Test responsive behavior on resize
                window.addEventListener('resize', () => {
                    log('Window resized');
                    this.initializeMobileMenuToggle();
                });
            }

            toggleMobileMenu() {
                log('toggleMobileMenu called');
                const mobileMenu = document.getElementById('mobile-menu');
                const menuBtn = document.getElementById('menu-btn');
                
                if (mobileMenu) {
                    const wasHidden = mobileMenu.classList.contains('hidden');
                    mobileMenu.classList.toggle('hidden');
                    mobileMenu.classList.toggle('show');
                    
                    const isHidden = mobileMenu.classList.contains('hidden');
                    log(`Mobile menu toggled: ${wasHidden} → ${isHidden}`);
                    
                    if (menuBtn) {
                        const isExpanded = !isHidden;
                        menuBtn.setAttribute('aria-expanded', isExpanded);
                        log(`Menu button aria-expanded set to: ${isExpanded}`);
                    }
                } else {
                    log('ERROR: Mobile menu not found!');
                }
            }

            initializeMobileMenuToggle() {
                const menuBtn = document.getElementById('menu-btn');
                if (menuBtn && !menuBtn.hasAttribute('data-initialized')) {
                    log('Menu button found, adding click listener');
                    
                    const isVisible = getComputedStyle(menuBtn).display !== 'none' && 
                                     getComputedStyle(menuBtn).visibility !== 'hidden';
                    
                    log(`Menu button visibility: ${isVisible}`);
                    log(`Window width: ${window.innerWidth}`);
                    
                    const clickHandler = (e) => {
                        log(`Menu button clicked! Event: ${e.type}`);
                        e.preventDefault();
                        e.stopPropagation();
                        this.toggleMobileMenu();
                    };
                    
                    menuBtn.addEventListener('click', clickHandler);
                    menuBtn.addEventListener('touchend', clickHandler);
                    menuBtn.addEventListener('pointerup', clickHandler);
                    
                    menuBtn.setAttribute('aria-expanded', 'false');
                    menuBtn.setAttribute('data-initialized', 'true');
                    
                    log('Event listeners attached to menu button');
                } else if (!menuBtn) {
                    log('WARNING: Menu button not found!');
                }
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            log('DOM Content Loaded');
            new NavigationManager();
            testResponsive();
        });

        // Also try on window load
        window.addEventListener('load', function() {
            log('Window Load Complete');
            testResponsive();
        });

        // Update screen size on resize
        window.addEventListener('resize', testResponsive);

        log('Script loaded');
    </script>
</body>
</html> 